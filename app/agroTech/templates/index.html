{% extends 'layout.html' %}

{% block style%}
<style>
      .navbar{
        margin-bottom:0;
        border-radius:0;
      }
      .carousel{
        width: 100%;
        margin: auto;
      }

      .carousel-inner > .item > img,
      .carousel-inner > .item > a > img {
        width: 100%;
        margin: auto;
      }
</style>
{% endblock %}

{% block nav %}
<li class="active"><a href="index.html">Home <span class="sr-only">(current)</span></a></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">New Pot <span class="caret"></span></a>
  <ul class="dropdown-menu">
    <li><a href="vegetables.html">Vegetables</a></li>
    <li role="separator" class="divider"></li>
    <li><a href="fruits.html">Fruits</a></li>
    <li role="separator" class="divider"></li>
    <li><a href="other.html">Other</a></li>
  </ul>
</li>
<li><a href="settings.html">Settings</a></li>
<li><a href="aboutUs.html">{{"{0:0.1f}".format(temp) }}</a></li>
{% endblock %}

{% block body %}
<!-- JUMBOTRON -->
    <div class="jumbotron text-center">
      <div class="container">
        <h1 id="date"></h1>
        <div class="container">
          <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
            <!-- Indicators -->
            <ol class="carousel-indicators">
              <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
              <li data-target="#carousel-example-generic" data-slide-to="1"></li>
              <li data-target="#carousel-example-generic" data-slide-to="2"></li>
              <li data-target="#carousel-example-generic" data-slide-to="3"></li>
            </ol>

            <!-- Wrapper for slides -->
            <div class="carousel-inner" role="listbox">
              <div class="item active">
                <img src="static/img/file.jpeg" class="img-responsive" alt="Flowers">
                <div class="carousel-caption">
                </div>
              </div>
              <div class="item">
                <img src="static/img/file-2.jpeg" class="img-responsive" alt="Flowers">
                <div class="carousel-caption">
                </div>
              </div>
              <div class="item">
                <img src="static/img/file-1.jpeg" class="img-responsive" alt="Flowers">
                <div class="carousel-caption">
                </div>
              </div>
              <div class="item">
                <img src="static/img/file-0.jpeg" class="img-responsive" alt="Flowers">
                <div class="carousel-caption">
                </div>
              </div>
            </div>

            <!-- Controls -->
            <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
              <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
              <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
        </div>
        <script>
          var d = new Date();
          var month = d.getMonth() + 1;
          var day = d.getDate() + 1;
          var year = d.getFullYear();
          var hour = d.getHours();
          var min = d.getMinutes();
          var months = ["Janurary", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
          if(min < 10){
            min = "0" + min;
          }
          if(month < 10){
            month = "0" + month;
          }
          if(day < 10){
            day = "0" + day;
          }
          var time = '';
          if(hour < 10){
            time = "0" + hour + ":" + min;
          }else{
            time = hour + ":" + min;
          }
          var time1 = '';
          if(hour < 12){
            if(hour == 0){
              hour = 12;
            }
            time1 = hour + ":" + min + '<small style="color: #333333;">am</small>';
          }else{
            time1 = (hour - 12) + ":" + min + '<small style="color: #333333;">pm</small>';
          }
          var dateNum = day + "/" + month + "/" + year;
          var dateNum1= month + "/" + day + "/" + year;
          var dateLet = months[month-1] +" "+ day + ", " + year;
          if(localStorage.date == null){
            document.getElementById("date").innerHTML = time1+"     "+ dateLet;
          }
          if(localStorage.date == 0){
            if(localStorage.time == 0){
              document.getElementById("date").innerHTML = time1+"     "+ dateLet;
            }
            if(localStorage.time == 1){
              document.getElementById("date").innerHTML = time +"     "+ dateLet;
            }
          }
          if(localStorage.date == 1){
            if(localStorage.time == 0){
              document.getElementById("date").innerHTML = time1 +"     "+ dateNum;
            }
            if(localStorage.time == 1){
              document.getElementById("date").innerHTML = time +"     "+ dateNum;
            }
          }
          if(localStorage.date == 2){
            if(localStorage.time == 0){
              document.getElementById("date").innerHTML = time1 +"     "+ dateNum1;
            }
            if(localStorage.time == 1){
              document.getElementById("date").innerHTML = time +"     "+ dateNum1;
            }
          }
        </script>
        <noscript>Sorry, your browser does not support JavaScript.</noscript>
        <p>Specialists in agricultural technology.</p>
      </div>
    </div>

    <!-- TYPOGRAPHY -->
    <div class="container">
      <h1 class="page-header">My SmartPots <small>Working <em>more</em> so you do <em>less</em>.</small></h1>
      <div class="container">
        <table class="table table-striped table-bordered table-hover table-condensed">
          <tr>
            <th>Name</th>
            <th>Temp</th>
            <th>RH</th>
            <th>pH</th>
            <th>Life Cycle</th>
          </tr>
          <div id="SmartPots">
            <tr id="pot-1" class="danger"></tr>
            <tr id="pot-2" class="danger"></tr>
            <tr id="pot-3" class="danger"></tr>
            <tr id="pot-4" class="danger"></tr>
            <tr id="pot-5" class="danger"></tr>
            <tr id="pot-6" class="danger"></tr>
            <tr id="pot1" class="success"></tr>
            <tr id="pot2" class="success"></tr>
            <tr id="pot3" class="success"></tr>
            <tr id="pot4" class="success"></tr>
            <tr id="pot5" class="success"></tr>
            <tr id="pot6" class="success"></tr>
          </div>
        </table>
        <button type="button" id="newPot" class="btn btn-primary" onclick="location.href='vegetables.html';">
          New Pot
        </button>
      </div>
      <script>
         // addPot(1,0,'Potato',33.2,76,5.9,11,0);
         // addPot(-1,1,'Tomato',31.5,33,6.9,75,1);
         // addPot(-2,2,'Avocado',33.8,12,6.4,32,2);
         // addPot(-3,3,'Cilantro',24.5,45,5.5,45,3);
         // addPot(2,4,'Sunflower',23.6,61,7.1,56,0);
        function addPot(id_pot,id_plant,name,temp,rh,ph,lc,alert){
          var s = '<td><a href="fruits.html" style="text-decoration: none; color: #000000;">'+ name + '</a></td>';
          var s1 = '<td>'+ temp + '</td>';
          var s2 = '<td>'+ rh + '%</td>';
          var st = '<td>'+ ph + '</td>';
          if(alert == 1){
            s1 = '<td><strong>'+ temp + '</strong></td>';
          }
          if(alert == 2){
            s2 = '<td><strong>'+ rh + '%</strong></td>';
          }
          if(alert == 3){
            st = '<td><strong>'+ ph + '</strong></td>';
          }
          var st1 = '';
          var st2 = '';
          if(lc < 34){
            st1 = '<td><div class="progress"><div class="progress-bar progress-bar-warning progress-bar-striped active" style="width:'+lc+'%;">';
            st2 = st1 + lc + '%</div></div></td>';
          }
          if(lc < 67 && lc > 34){
            st1 = '<td><div class="progress"><div class="progress-bar progress-bar-info progress-bar-striped active" style="width:'+lc+'%;">';
            st2 = st1 + lc + '%</div></div></td>';
          }
          if(lc >= 67){
            st1 = '<td><div class="progress"><div class="progress-bar progress-bar-success progress-bar-striped active" style="width:'+lc+'%;">';
            st2 = st1 + lc + '%</div></div></td>';
          }
          var sf = '</tr>';
          var html = s + s1 + s2 + st + st2;
          var pot = 'pot' + id_pot;
          document.getElementById(pot).innerHTML = html;
        }
        </script>
        <script>
          var requestURL = 'static/data/plants.json';
          var request = new XMLHttpRequest();
          request.open('GET', requestURL);
          request.responseType = 'json';
          request.send();
          request.onload = function() {
            var plants = request.response;
            newPot(plants,localStorage.plantId);
            //newPot(plants,{{plantId}});
            //localStorage.removeItem("plantId");
          }
          function newPot(jsonObj,plantId){
            if(plantId < 1000){
              var objs = jsonObj['Vegetables'];
              for(var i = 0; i < objs.length; i++){
                if(plantId == objs[i].id){
                  addPot(1,plantId,objs[i].name,0,0,0,0,0);
                }
              }
            }
            if(plantId >= 1000 && plantId < 2000){
              var objs = jsonObj['Fruits'];
              for(var i = 0; i < objs.length; i++){
                if(plantId == objs[i].id){
                  addPot(1,plantId,objs[i].name,0,0,0,0,0);
                }
              }
            }
            if(plantId >= 2000){
              var objs = jsonObj['Other'];
              for(var i = 0; i < objs.length; i++){
                if(plantId == objs[i].id){
                  addPot(1,plantId,objs[i].name,0,0,0,0,0);
                }
              }
            }
          }
        </script>
    </div>
{% endblock %}
